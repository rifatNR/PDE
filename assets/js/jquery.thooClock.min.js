!function(e){e.fn.thooClock=function(o){this.each(function(){function a(e){return Math.PI/180*e}function r(e,o){var a,r,t,n,i,s,l,d,u,f,m,h,C,v,z,g,I;for(a=parseInt(T-p.size/50,10),r=T-p.size/400,c.beginPath(),c.arc(0,0,r,0,360,!1),c.fillStyle=o,c.fill(),t=1;60>=t;t+=1)n=Math.PI/30*t,i=Math.sin(n),s=Math.cos(n),t%5===0?(c.lineWidth=parseInt(p.size/50,10),l=i*(a-a/9),d=s*-(a-a/9),u=i*a,f=s*-a,m=i*(a-a/4.2),h=s*-(a-a/4.2),C=t/5,c.textBaseline="middle",v=parseInt(p.size/13,10),c.font="100 "+v+"px helvetica",z=c.measureText(C).width,c.beginPath(),c.fillStyle=e,p.showNumerals&&c.fillText(C,m-z/2,h)):(c.lineWidth=parseInt(p.size/100,10),l=i*(a-a/20),d=s*-(a-a/20),u=i*a,f=s*-a),c.beginPath(),c.strokeStyle=e,c.lineCap="round",c.moveTo(l,d),c.lineTo(u,f),c.stroke();void 0!==p.brandText&&(c.font="100 "+parseInt(p.size/28,10)+"px helvetica",g=c.measureText(p.brandText).width,c.fillText(p.brandText,-(g/2),p.size/6)),void 0!==p.brandText2&&(c.textBaseline="middle",c.font="100 "+parseInt(p.size/44,10)+"px helvetica",I=c.measureText(p.brandText2).width,c.fillText(p.brandText2,-(I/2),p.size/5))}function t(e){return e>=12&&(e-=12),e}function n(e){c.beginPath(),c.moveTo(0,0),c.lineTo(0,-1*e),c.stroke()}function i(e,o){var r=T-p.size/40;c.save(),c.lineWidth=parseInt(p.size/150,10),c.lineCap="round",c.strokeStyle=o,c.rotate(a(6*e)),c.shadowColor="rgba(0,0,0,.5)",c.shadowBlur=parseInt(p.size/80,10),c.shadowOffsetX=parseInt(p.size/200,10),c.shadowOffsetY=parseInt(p.size/200,10),n(r),c.beginPath(),c.moveTo(0,0),c.lineTo(0,r/15),c.lineWidth=parseInt(p.size/30,10),c.stroke(),c.beginPath(),c.arc(0,0,parseInt(p.size/30,10),0,360,!1),c.fillStyle=o,c.fill(),c.restore()}function s(e,o){var r=p.size/2.2;c.save(),c.lineWidth=parseInt(p.size/50,10),c.lineCap="round",c.strokeStyle=o,c.rotate(a(6*e)),c.shadowColor="rgba(0,0,0,.5)",c.shadowBlur=parseInt(p.size/50,10),c.shadowOffsetX=parseInt(p.size/250,10),c.shadowOffsetY=parseInt(p.size/250,10),n(r),c.restore()}function l(e,o){var r=p.size/3;c.save(),c.lineWidth=parseInt(p.size/25,10),c.lineCap="round",c.strokeStyle=o,c.rotate(a(30*e)),c.shadowColor="rgba(0,0,0,.5)",c.shadowBlur=parseInt(p.size/50,10),c.shadowOffsetX=parseInt(p.size/300,10),c.shadowOffsetY=parseInt(p.size/300,10),n(r),c.restore()}function d(e){var o,a;return void 0!==e&&(o=t(e.getHours()),a=e.getMinutes()),parseInt(o,10)+a/60}function u(e,o,r){var t=p.size/2.4;c.save(),c.lineWidth=parseInt(p.size/30,10),c.lineCap="butt",c.strokeStyle=o,e=d(e),c.rotate(a(30*e)),c.shadowColor="rgba(0,0,0,.5)",c.shadowBlur=parseInt(p.size/55,10),c.shadowOffsetX=parseInt(p.size/300,10),c.shadowOffsetY=parseInt(p.size/300,10),c.beginPath(),c.moveTo(0,0),c.lineTo(0,-1*(t-p.size/10)),c.stroke(),c.beginPath(),c.strokeStyle=r,c.moveTo(0,-1*(t-p.size/10)),c.lineTo(0,-1*t),c.stroke(),c.beginPath(),c.arc(0,0,parseInt(p.size/24,10),0,360,!1),c.fillStyle=o,c.fill(),c.restore()}function f(e){return"+0"!==e&&""!==e?"+"===e.charAt(0)?+e.substring(1):-e.substring(1):0}function m(o,a){var n,d,h,C,v,z,g,I;n=new Date,d=n.getSeconds(),v=n.getMinutes(),h=v+d/60,C=n.getHours(),z=t(C+f(p.hourCorrection))+h/60,c.clearRect(-T,-T,p.size,p.size),r(p.dialColor,p.dialBackgroundColor),void 0!==p.alarmTime&&u(p.alarmTime,p.alarmHandColor,p.alarmHandTipColor),l(z,p.hourHandColor),s(h,p.minuteHandColor),i(d,p.secondHandColor),a+=1,1===a&&(e(p).trigger("onEverySecond"),a=0),void 0!==p.alarmTime&&(g=60*p.alarmTime.getHours()*60+60*p.alarmTime.getMinutes()+p.alarmTime.getSeconds()),I=60*C*60+60*v+d,I>=g&&(o+=1),o<=p.alarmCount&&0!==o&&e(p).trigger("onAlarm");var w=1e3-(new Date).getTime()%1e3;setTimeout(function(){m(o,a)},w)}var h,c,p,C,v,T,z,g;C={size:250,dialColor:"#000000",dialBackgroundColor:"transparent",secondHandColor:"#F3A829",minuteHandColor:"#222222",hourHandColor:"#222222",alarmHandColor:"#FFFFFF",alarmHandTipColor:"#026729",hourCorrection:"+0",alarmCount:1,showNumerals:!0},v=e.extend({},C,o),p=this,p.size=v.size,p.dialColor=v.dialColor,p.dialBackgroundColor=v.dialBackgroundColor,p.secondHandColor=v.secondHandColor,p.minuteHandColor=v.minuteHandColor,p.hourHandColor=v.hourHandColor,p.alarmHandColor=v.alarmHandColor,p.alarmHandTipColor=v.alarmHandTipColor,p.hourCorrection=v.hourCorrection,p.showNumerals=v.showNumerals,p.brandText=v.brandText,p.brandText2=v.brandText2,p.alarmCount=v.alarmCount,p.alarmTime=v.alarmTime,p.onAlarm=v.onAlarm,p.offAlarm=v.offAlarm,p.onEverySecond=v.onEverySecond,z=0,h=document.createElement("canvas"),c=h.getContext("2d"),h.width=this.size,h.height=this.size,e(h).appendTo(p),T=parseInt(p.size/2,10),c.translate(T,T),e.fn.thooClock.setAlarm=function(e){var o;if(e instanceof Date)o=e;else{var a=e.split(":");o=new Date;for(var r=0;3>r;r++)a[r]=Math.floor(a[r]),(a[r]!==a[r]||a[r]>59)&&(a[r]=0),0==r&&a[r]>23&&(a[r]=0);o.setHours(a[0],a[1],a[2])}p.alarmTime=o},e.fn.thooClock.clearAlarm=function(){p.alarmTime=void 0,m(0,0),e(p).trigger("offAlarm")},void 0!==p.onAlarm&&e(p).on("onAlarm",function(e){p.onAlarm(),e.preventDefault(),e.stopPropagation()}),void 0!==p.onEverySecond&&e(p).on("onEverySecond",function(e){p.onEverySecond(),e.preventDefault()}),void 0!==p.offAlarm&&e(p).on("offAlarm",function(e){p.offAlarm(),e.stopPropagation(),e.preventDefault()}),g=0,m(z,g)})}}(jQuery);